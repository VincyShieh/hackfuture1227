<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‡å®™æ¼«æ¸¸ - æ˜Ÿé™…å‘ç°ä¹‹æ—…</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* æ˜Ÿç©ºèƒŒæ™¯ */
        .stars-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* æ¸¸æˆå®¹å™¨ */
        .game-container {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* åœºæ™¯å®¹å™¨ */
        .scene {
            display: none;
            position: relative;
            width: 100%;
            height: 100%;
            animation: fadeIn 1s ease-in-out;
        }

        .scene.active {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ ‡é¢˜æ ·å¼ */
        .title {
            font-size: 3em;
            color: #fff;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px rgba(255, 255, 255, 0.5); }
            to { text-shadow: 0 0 30px rgba(255, 255, 255, 0.8), 0 0 40px rgba(100, 200, 255, 0.6); }
        }

        /* æ§åˆ¶å° */
        .console {
            background: linear-gradient(145deg, rgba(30, 30, 60, 0.9), rgba(20, 20, 40, 0.9));
            border: 2px solid #4a9eff;
            border-radius: 20px;
            padding: 30px;
            margin: 20px auto;
            max-width: 600px;
            box-shadow: 0 0 30px rgba(74, 158, 255, 0.3);
        }

        /* èˆªå¤©å‘˜å‘å¯¼ */
        .astronaut-guide {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* æ¶ˆæ¯æ–‡æœ¬ */
        .message {
            color: #fff;
            font-size: 1.2em;
            line-height: 1.6;
            margin: 20px 0;
            max-width: 500px;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            margin: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.6);
        }

        /* æ˜Ÿå›¾ */
        .star-map {
            background: rgba(0, 0, 20, 0.8);
            border: 3px solid #4a9eff;
            border-radius: 20px;
            padding: 20px;
            margin: 20px auto;
            max-width: 800px;
            position: relative;
            height: 400px;
        }

        /* æ˜Ÿçƒ */
        .planet {
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .planet:hover {
            transform: scale(1.2);
            box-shadow: 0 0 30px currentColor;
        }

        .planet.mars {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #ff6b35, #c44569);
            top: 50px;
            left: 100px;
        }

        .planet.jupiter {
            width: 120px;
            height: 120px;
            background: linear-gradient(135deg, #ffa500, #ff6347);
            top: 150px;
            right: 150px;
        }

        .planet.saturn {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #f4e5c2, #d4a574);
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            position: relative;
        }

        .planet.saturn::after {
            content: '';
            position: absolute;
            width: 140px;
            height: 140px;
            border: 8px solid rgba(212, 165, 116, 0.6);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotateX(60deg);
        }

        /* æ˜Ÿçƒè§†å›¾ */
        .planet-view {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            animation: rotate 20s linear infinite;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* å…´è¶£ç‚¹ */
        .interest-point {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.3));
            border-radius: 50%;
            cursor: pointer;
            animation: pulse 2s infinite;
            pointer-events: auto;
        }

        .interest-point.explored {
            background: radial-gradient(circle, rgba(76, 175, 80, 0.9), rgba(76, 175, 80, 0.3));
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.3); opacity: 1; }
        }

        /* ä¿¡æ¯å¡ç‰‡ */
        .info-card {
            background: linear-gradient(145deg, rgba(30, 30, 60, 0.95), rgba(20, 20, 40, 0.95));
            border: 2px solid #4a9eff;
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto;
            max-width: 400px;
            color: white;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .info-card.show {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* æ ‡æœ¬å¢™ */
        .specimen-wall {
            background: linear-gradient(145deg, rgba(20, 20, 40, 0.9), rgba(10, 10, 30, 0.9));
            border: 3px solid #4a9eff;
            border-radius: 20px;
            padding: 30px;
            margin: 20px auto;
            max-width: 900px;
            min-height: 400px;
        }

        .specimen-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .specimen-item {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            margin: 10px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .specimen-item:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(74, 158, 255, 0.5);
        }

        /* åæ€é—®é¢˜ */
        .reflection-question {
            color: white;
            font-size: 1.3em;
            margin: 30px 0;
            max-width: 600px;
            line-height: 1.6;
            text-align: center;
        }

        .choice-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        .choice-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1em;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .choice-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
        }

        /* æ¢ç´¢æ ‡è®° */
        .explored-mark {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #4CAF50;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* æˆåŠŸæ¶ˆæ¯ */
        .success-message {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 15px auto;
            max-width: 450px;
            text-align: center;
            animation: slideIn 0.5s ease-out;
        }

        /* è­¦å‘Šæ¶ˆæ¯ */
        .warning-message {
            background: rgba(255, 107, 107, 0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px auto;
            max-width: 400px;
            animation: slideIn 0.5s ease-out;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .title {
                font-size: 2em;
            }

            .console, .star-map, .specimen-wall {
                max-width: 95%;
                padding: 15px;
            }

            .planet {
                width: 60px;
                height: 60px;
                font-size: 0.8em;
            }

            .planet.jupiter {
                width: 80px;
                height: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- æ˜Ÿç©ºèƒŒæ™¯ -->
    <div class="stars-container" id="starsContainer"></div>

    <!-- æ¸¸æˆå®¹å™¨ -->
    <div class="game-container">
        <!-- åœºæ™¯ä¸€ï¼šå…³å¡å¼€å¯ -->
        <div class="scene active" id="scene1">
            <h1 class="title">âœ¨ æ˜Ÿç©ºé‚€è¯·</h1>
            <div class="console">
                <div class="astronaut-guide">ğŸ‘©â€ğŸš€</div>
                <div class="message">
                    å‘¼å«åœ°çƒå°æ¢é™©å®¶ï¼æˆ‘æ˜¯ä½ çš„å¤ªç©ºå‘å¯¼ç‹äºšå¹³ã€‚<br><br>
                    æˆ‘ä»¬çš„å®‡å®™é£èˆ¹å·²ç»å……èƒ½å®Œæ¯•ï¼Œå‡†å¤‡å‰å¾€å¤ªé˜³ç³»çš„å‡ ä¸ªç¥ç§˜æ˜Ÿçƒè¿›è¡Œç§‘å­¦è€ƒå¯Ÿã€‚<br><br>
                    è¿™æ¬¡çš„ä»»åŠ¡ä¸æ˜¯ç«èµ›ï¼Œè€Œæ˜¯ä»”ç»†åœ°è§‚å¯Ÿå’Œè®°å½•ã€‚<br>
                    æ¯é¢—æ˜Ÿçƒéƒ½æ˜¯å®‡å®™ä¸­ç‹¬ä¸€æ— äºŒçš„å®çŸ³ï¼Œç­‰ä½ æ¥å‘ç°å®ƒä»¬çš„ç§˜å¯†ã€‚<br><br>
                    å‡†å¤‡å¥½å¼€å§‹ä½ çš„æ˜Ÿé™…å‘ç°ä¹‹æ—…äº†å—ï¼Ÿ
                </div>
                <button class="btn" onclick="startNavigation()">ğŸš€ å¯åŠ¨æ˜Ÿé™…å¯¼èˆªï¼</button>
            </div>
        </div>

        <!-- åœºæ™¯äºŒï¼šå‡†å¤‡å®¤ -->
        <div class="scene" id="scene2">
            <h1 class="title">ğŸ—ºï¸ ç§‘è€ƒä»»åŠ¡ç®€æŠ¥</h1>
            <div class="star-map">
                <h3 style="color: white; margin-bottom: 20px; text-align: center;">ç§‘è€ƒä»»åŠ¡ï¼šæ¢ç´¢ 3 é¢—æ˜Ÿçƒï¼Œå®Œæˆä½ çš„å®‡å®™æ ‡æœ¬æ”¶é›†</h3>
                <div style="color: #ccc; margin: 15px 0; text-align: center;">ç‚¹å‡»æ˜Ÿå›¾ä¸Šçš„æ˜Ÿçƒï¼Œå³å¯è‡ªåŠ¨é©¾é©¶å‰å¾€ã€‚åœ¨æ˜Ÿçƒä¸Šï¼Œè¯·ä»”ç»†ç‚¹å‡»ä½ æ„Ÿå…´è¶£çš„åœ°æ–¹è¿›è¡Œè°ƒæŸ¥ï¼</div>

                <div class="planet mars" onclick="selectPlanet('mars')">ç«æ˜Ÿ</div>
                <div class="planet jupiter" onclick="selectPlanet('jupiter')">æœ¨æ˜Ÿ</div>
                <div class="planet saturn" onclick="selectPlanet('saturn')">åœŸæ˜Ÿ</div>
            </div>

            <div style="margin: 20px 0;">
                <button id="spacesuitBtn" class="btn" onclick="wearSpacesuit()" style="font-size: 1.2em; padding: 18px 45px; background: linear-gradient(135deg, #ff6b6b, #ff8e8e);">
                    ğŸ‘©â€ğŸš€ ç©¿ä¸Šå®‡èˆªæœ
                </button>
            </div>

            <div style="margin-top: 30px; color: #aaa; text-align: center;">
                <p>ğŸ“ æ¢ç´¢æç¤ºï¼š</p>
                <p>1ï¸âƒ£ å…ˆç©¿æˆ´å®‡èˆªæœç¡®ä¿å®‰å…¨</p>
                <p>2ï¸âƒ£ ç‚¹å‡»æ˜Ÿå›¾ä¸Šçš„æ˜Ÿçƒé€‰æ‹©ç›®æ ‡</p>
                <p>3ï¸âƒ£ åœ¨æ˜Ÿçƒä¸Šç‚¹å‡»å‘å…‰ç‚¹æ¢ç´¢çŸ¥è¯†</p>
            </div>

            <button class="btn" onclick="backToMenu()" style="margin-top: 20px; background: linear-gradient(135deg, #666, #444);">è¿”å›</button>
        </div>

        <!-- åœºæ™¯ä¸‰ï¼šæ˜Ÿçƒæ¢ç´¢ -->
        <div class="scene" id="scene3">
            <h1 class="title" id="planetName">æ˜Ÿçƒæ¢ç´¢</h1>
            <div class="planet-view" id="planetView">
                <!-- å…´è¶£ç‚¹å°†é€šè¿‡JSåŠ¨æ€æ·»åŠ  -->
            </div>

            <div class="info-card" id="infoCard">
                <h3 id="infoTitle"></h3>
                <p id="infoContent"></p>
                <button class="btn" onclick="closeInfo()">ç»§ç»­æ¢ç´¢</button>
            </div>

            <div class="info-card" id="completeCard" style="display: none;">
                <h3>ğŸ‰ æ˜Ÿçƒæ•°æ®é‡‡é›†å®Œæ¯•ï¼</h3>
                <p>ä½ å·²ç»æˆåŠŸæ¢ç´¢äº†è¿™é¢—æ˜Ÿçƒçš„æ‰€æœ‰ä¸»è¦å…´è¶£ç‚¹ï¼</p>
                <button class="btn" onclick="selectNextPlanet()">é€‰æ‹©ä¸‹ä¸€é¢—æ˜Ÿçƒ</button>
            </div>

            <button class="btn" onclick="backToStarMap()">è¿”å›æ˜Ÿå›¾</button>
        </div>

        <!-- åœºæ™¯å››ï¼šæ ‡æœ¬å¢™ -->
        <div class="scene" id="scene4">
            <h1 class="title">ğŸ† æ˜Ÿçƒæ ‡æœ¬å¢™</h1>
            <div class="specimen-wall">
                <h3 style="color: white; margin-bottom: 20px; text-align: center;">æ­å–œä½ æˆä¸ºäº†ä¸€åå°å°çš„è¡Œæ˜Ÿç§‘å­¦å®¶ï¼</h3>
                <p style="color: #ccc; margin: 15px 0; text-align: center;">ä½ æ”¶é›†çš„å®‡å®™çŸ¥è¯†ï¼Œæ˜¯ä½ æœ€å®è´µçš„è´¢å¯Œ</p>

                <div class="specimen-grid" id="specimenGrid">
                    <!-- åŠ¨æ€ç”Ÿæˆæ ‡æœ¬ -->
                </div>
            </div>
            <button class="btn" onclick="finalReflection()">ç»§ç»­ä½ çš„æ¢ç´¢ä¹‹æ—…</button>
        </div>

        <!-- åœºæ™¯äº”ï¼šæƒ…æ„Ÿå‡å -->
        <div class="scene" id="scene5">
            <h1 class="title">âœ¨ å®‡å®™ä¸è‡ªæˆ‘</h1>
            <div class="astronaut-guide">ğŸ‘©â€ğŸš€</div>

            <div class="reflection-question">
                åœ¨æˆ‘ä»¬å¹¿é˜”çš„å®‡å®™ä¸­ï¼Œæ¯ä¸€é¢—æ˜Ÿçƒéƒ½å¦‚æ­¤ä¸åŒï¼Œæœ‰ç€è‡ªå·±ç‹¬ç‰¹çš„æ•…äº‹ã€‚<br>
                å°±åƒæˆ‘ä»¬æ¯ä¸ªå¥³å­©ä¸€æ ·ï¼Œéƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚<br>
                ä½ çš„ç‹¬ç‰¹ä¹‹å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
            </div>

            <div class="choice-buttons">
                <button class="choice-btn" onclick="makeChoice('curiosity')">æˆ‘çš„å¥½å¥‡å¿ƒåƒå®‡å®™ä¸€æ ·å¤§ï¼</button>
                <button class="choice-btn" onclick="makeChoice('caring')">æˆ‘åƒåœ°çƒä¸€æ ·ï¼Œå…³çˆ±èº«è¾¹çš„æ¯ä¸€ä¸ªæœ‹å‹ã€‚</button>
                <button class="choice-btn" onclick="makeChoice('shining')">æˆ‘æ­£åœ¨åŠªåŠ›ï¼Œæƒ³æˆä¸ºä¸€é¢—å‘å…‰çš„æ˜Ÿæ˜Ÿï¼</button>
            </div>

            <div class="info-card" id="finalMessage" style="display: none;">
                <p id="finalText"></p>
                <button class="btn" onclick="restartGame()">é‡æ–°å¼€å§‹æ¢ç´¢</button>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆçŠ¶æ€ç®¡ç†
        const gameState = {
            currentScene: 1,
            exploredPlanets: [],
            currentPlanet: null,
            discoveredPoints: {
                mars: [],
                jupiter: [],
                saturn: []
            },
            wearingSpacesuit: false
        };

        // çŠ¶æ€æŒä¹…åŒ–å‡½æ•°
        function saveGameState() {
            localStorage.setItem('spacetrip_gameState', JSON.stringify(gameState));
        }

        function loadGameState() {
            const saved = localStorage.getItem('spacetrip_gameState');
            if (saved) {
                const savedState = JSON.parse(saved);
                gameState.exploredPlanets = savedState.exploredPlanets || [];
                gameState.discoveredPoints = savedState.discoveredPoints || {
                    mars: [],
                    jupiter: [],
                    saturn: []
                };
                gameState.wearingSpacesuit = savedState.wearingSpacesuit || false;
            }
        }

        function resetGameState() {
            gameState.exploredPlanets = [];
            gameState.currentPlanet = null;
            gameState.discoveredPoints = {
                mars: [],
                jupiter: [],
                saturn: []
            };
            gameState.wearingSpacesuit = false;
            gameState.currentScene = 1;
            localStorage.removeItem('spacetrip_gameState');
        }

        // æ˜Ÿçƒæ•°æ®
        const planetsData = {
            mars: {
                name: 'ç«æ˜Ÿ',
                gradient: 'linear-gradient(135deg, #ff6b35, #c44569)',
                points: [
                    { id: 'olympus', title: 'å¥¥æ—åŒ¹æ–¯å±±', content: 'å¤ªé˜³ç³»æœ€é«˜å±±å³°ï¼é«˜åº¦æ˜¯ç ç©†æœ—ç›å³°çš„3å€å“¦ï¼è¿™é‡Œå‡ ä¹æ²¡æœ‰ç©ºæ°”ï¼Œéå¸¸å¯’å†·ã€‚', top: '20%', left: '30%' },
                    { id: 'valley', title: 'æ°´æ‰‹å³¡è°·', content: 'ç«æ˜Ÿä¸Šå·¨å¤§çš„å³¡è°·ç³»ç»Ÿï¼Œé•¿åº¦ç›¸å½“äºç¾å›½çº½çº¦åˆ°æ´›æ‰çŸ¶çš„è·ç¦»ï¼', top: '50%', left: '70%' },
                    { id: 'polar', title: 'æåœ°å†°ç›–', content: 'ç«æ˜Ÿçš„åŒ—æå’Œå—æè¦†ç›–ç€å¹²å†°å’Œæ°´å†°ï¼Œéšç€å­£èŠ‚å˜åŒ–è€Œæ¶ˆé•¿ã€‚', top: '70%', left: '20%' }
                ]
            },
            jupiter: {
                name: 'æœ¨æ˜Ÿ',
                gradient: 'linear-gradient(135deg, #ffa500, #ff6347)',
                points: [
                    { id: 'greatred', title: 'å¤§çº¢æ–‘', content: 'ä¸€ä¸ªè¶…çº§å¤§é£æš´ï¼å·²ç»åˆ®äº†è‡³å°‘350å¹´ï¼Œå¤§åˆ°å¯ä»¥è£…ä¸‹æ•´ä¸ªåœ°çƒã€‚', top: '20%', left: '30%' },
                    { id: 'io', title: 'æœ¨å«ä¸€', content: 'æœ¨æ˜Ÿçš„å«æ˜Ÿä¹‹ä¸€ï¼Œæ˜¯å¤ªé˜³ç³»ä¸­ç«å±±æ´»åŠ¨æœ€æ´»è·ƒçš„å¤©ä½“ï¼', top: '50%', left: '70%' },
                    { id: 'magnetic', title: 'ç£åœº', content: 'æœ¨æ˜Ÿæ‹¥æœ‰å¤ªé˜³ç³»ä¸­æœ€å¼ºçš„ç£åœºï¼Œæ¯”åœ°çƒç£åœºå¼º20,000å€ï¼', top: '70%', left: '20%' }
                ]
            },
            saturn: {
                name: 'åœŸæ˜Ÿ',
                gradient: 'linear-gradient(135deg, #f4e5c2, #d4a574)',
                points: [
                    { id: 'rings', title: 'è¡Œæ˜Ÿç¯', content: 'è¿™äº›å…‰ç¯ä¸»è¦æ˜¯ç”±å†°å—å’Œå²©çŸ³ç»„æˆçš„ï¼Œåƒç»™åœŸæ˜Ÿç©¿ä¸Šäº†ä¸€æ¡é—ªé—ªå‘å…‰çš„è£¤å­ã€‚', top: '20%', left: '30%' },
                    { id: 'titan', title: 'åœŸå«å…­', content: 'åœŸæ˜Ÿæœ€å¤§çš„å«æ˜Ÿï¼Œæ‹¥æœ‰æµ“åšçš„å¤§æ°”å±‚å’Œæ¶²æ€ç”²çƒ·æ¹–æ³Šï¼', top: '50%', left: '70%' },
                    { id: 'hexagon', title: 'å…­è¾¹å½¢é£æš´', content: 'åœŸæ˜ŸåŒ—ææœ‰ä¸€ä¸ªå·¨å¤§çš„å…­è¾¹å½¢é£æš´ï¼Œæ¯10.5å°æ—¶æ—‹è½¬ä¸€åœˆï¼', top: '70%', left: '20%' }
                ]
            }
        };

        // åˆå§‹åŒ–æ˜Ÿç©ºèƒŒæ™¯
        function initStars() {
            const container = document.getElementById('starsContainer');
            const starCount = 200;

            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                const size = Math.random() * 3 + 1;
                star.style.width = size + 'px';
                star.style.height = size + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                container.appendChild(star);
            }
        }

        // åœºæ™¯åˆ‡æ¢
        function switchScene(sceneNumber) {
            document.querySelectorAll('.scene').forEach(scene => {
                scene.classList.remove('active');
            });
            document.getElementById('scene' + sceneNumber).classList.add('active');
            gameState.currentScene = sceneNumber;

            if (sceneNumber === 2) {
                updatePlanetsStatus();
            }
        }

        // æ›´æ–°æ˜Ÿå›¾ä¸Šçš„æ˜ŸçƒçŠ¶æ€
        function updatePlanetsStatus() {
            const starMap = document.querySelector('.star-map');
            gameState.exploredPlanets.forEach(planetName => {
                const planetElement = document.querySelector(`.planet.${planetName}`);
                if (planetElement) {
                    if (!planetElement.querySelector('.explored-mark')) {
                        const mark = document.createElement('div');
                        mark.innerHTML = 'âœ“';
                        mark.className = 'explored-mark';
                        planetElement.style.position = 'relative';
                        planetElement.appendChild(mark);
                    }
                }
            });
        }

        // åœºæ™¯ä¸€ï¼šå¯åŠ¨å¯¼èˆª
        function startNavigation() {
            switchScene(2);
        }

        // ç©¿ä¸Šå®‡èˆªæœ
        function wearSpacesuit() {
            gameState.wearingSpacesuit = true;

            const starMap = document.querySelector('.star-map');
            const successMsg = document.createElement('div');
            successMsg.className = 'success-message';
            successMsg.innerHTML = 'âœ… å®‡èˆªæœç©¿æˆ´å®Œæˆï¼<br>ä½ ç°åœ¨å¯ä»¥å®‰å…¨åœ°è¿›è¡Œå¤ªç©ºæ¢ç´¢äº†ï¼<br>ğŸš€ ç‚¹å‡»ä»»æ„æ˜Ÿçƒå¼€å§‹æ¢ç´¢ï¼';
            starMap.appendChild(successMsg);

            const button = document.getElementById('spacesuitBtn');
            button.textContent = 'âœ… å®‡èˆªæœå·²ç©¿æˆ´';
            button.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
            button.style.opacity = '0.8';
            button.style.cursor = 'not-allowed';
            button.onclick = null;

            document.querySelectorAll('.planet').forEach(planet => {
                planet.style.animation = 'pulse 1.5s infinite';
            });

            setTimeout(() => {
                successMsg.remove();
            }, 4000);

            saveGameState();
        }

        // åœºæ™¯äºŒï¼šé€‰æ‹©æ˜Ÿçƒ
        function selectPlanet(planetName) {
            if (!gameState.wearingSpacesuit) {
                const starMap = document.querySelector('.star-map');
                const prompt = document.createElement('div');
                prompt.className = 'warning-message';
                prompt.innerHTML = 'ğŸ‘©â€ğŸš€ è¯·å…ˆç‚¹å‡»"ç©¿ä¸Šå®‡èˆªæœ"æŒ‰é’®ï¼Œç¡®ä¿å®‰å…¨åå†è¿›è¡Œæ¢ç´¢ï¼';
                starMap.appendChild(prompt);

                setTimeout(() => {
                    prompt.remove();
                }, 3000);
                return;
            }

            gameState.currentPlanet = planetName;
            const planetData = planetsData[planetName];

            document.getElementById('planetName').textContent = planetData.name + ' æ¢ç´¢';
            const planetView = document.getElementById('planetView');
            planetView.style.background = planetData.gradient;

            // æ¸…ç©ºæ—§çš„å…´è¶£ç‚¹
            planetView.innerHTML = '';

            // æ·»åŠ æ–°çš„å…´è¶£ç‚¹
            planetData.points.forEach(point => {
                const interestPoint = document.createElement('div');
                interestPoint.className = 'interest-point';
                interestPoint.style.top = point.top;
                interestPoint.style.left = point.left;
                interestPoint.dataset.id = point.id;

                // æ£€æŸ¥æ˜¯å¦å·²æ¢ç´¢
                if (gameState.discoveredPoints[planetName].includes(point.id)) {
                    interestPoint.classList.add('explored');
                }

                interestPoint.onclick = () => showInfo(point.id);
                planetView.appendChild(interestPoint);
            });

            switchScene(3);
        }

        function backToStarMap() {
            switchScene(2);
        }

        function backToMenu() {
            switchScene(1);
        }

        // åœºæ™¯ä¸‰ï¼šæ˜Ÿçƒæ¢ç´¢
        function showInfo(pointId) {
            if (!gameState.currentPlanet) return;

            const planetData = planetsData[gameState.currentPlanet];
            const pointData = planetData.points.find(p => p.id === pointId);

            if (gameState.discoveredPoints[gameState.currentPlanet].includes(pointId)) {
                document.getElementById('infoTitle').textContent = 'å·²æ¢ç´¢';
                document.getElementById('infoContent').textContent = 'ä½ å·²ç»æ¢ç´¢è¿‡è¿™ä¸ªåœ°ç‚¹äº†ï¼å¯ä»¥ç‚¹å‡»å…¶ä»–æœªæ¢ç´¢çš„å…´è¶£ç‚¹ç»§ç»­å‘ç°ã€‚';
                document.getElementById('infoCard').classList.add('show');
                return;
            }

            gameState.discoveredPoints[gameState.currentPlanet].push(pointId);
            saveGameState();

            markInterestPointExplored(pointId);

            document.getElementById('infoTitle').textContent = pointData.title;
            document.getElementById('infoContent').textContent = pointData.content;
            document.getElementById('infoCard').classList.add('show');

            const totalPoints = planetData.points.length;
            if (gameState.discoveredPoints[gameState.currentPlanet].length === totalPoints) {
                setTimeout(() => {
                    completePlanetExploration();
                }, 3000);
            }
        }

        function markInterestPointExplored(pointId) {
            const points = document.querySelectorAll('.interest-point');
            points.forEach(point => {
                if (point.dataset.id === pointId) {
                    point.classList.add('explored');
                    point.onclick = () => {
                        document.getElementById('infoTitle').textContent = 'å·²æ¢ç´¢';
                        document.getElementById('infoContent').textContent = 'ä½ å·²ç»æ¢ç´¢è¿‡è¿™ä¸ªåœ°ç‚¹äº†ï¼';
                        document.getElementById('infoCard').classList.add('show');
                    };
                }
            });
        }

        function closeInfo() {
            document.getElementById('infoCard').classList.remove('show');
        }

        function completePlanetExploration() {
            document.getElementById('completeCard').style.display = 'block';
            document.getElementById('infoCard').classList.remove('show');

            if (!gameState.exploredPlanets.includes(gameState.currentPlanet)) {
                gameState.exploredPlanets.push(gameState.currentPlanet);
            }
            saveGameState();
        }

        function selectNextPlanet() {
            document.getElementById('completeCard').style.display = 'none';
            switchScene(2);

            if (gameState.exploredPlanets.length === 3) {
                setTimeout(() => {
                    showSpecimenWall();
                }, 1000);
            }
        }

        // åœºæ™¯å››ï¼šæ ‡æœ¬å¢™
        function showSpecimenWall() {
            switchScene(4);
            generateSpecimens();
        }

        function generateSpecimens() {
            const grid = document.getElementById('specimenGrid');
            grid.innerHTML = '';

            gameState.exploredPlanets.forEach(planetName => {
                const planetData = planetsData[planetName];
                const specimen = document.createElement('div');
                specimen.className = 'specimen-item';
                specimen.style.background = planetData.gradient;
                specimen.textContent = planetData.name;
                specimen.onclick = () => reviewPlanet(planetName);
                grid.appendChild(specimen);
            });
        }

        function reviewPlanet(planetName) {
            const planetData = planetsData[planetName];
            const info = planetData.points.map(p => `â€¢ ${p.title}: ${p.content}`).join('\n\n');
            document.getElementById('infoTitle').textContent = planetData.name + ' çŸ¥è¯†å›é¡¾';
            document.getElementById('infoContent').innerText = info;
            document.getElementById('infoCard').classList.add('show');
        }

        function finalReflection() {
            switchScene(5);
        }

        // åœºæ™¯äº”ï¼šæƒ…æ„Ÿå‡å
        function makeChoice(choice) {
            const responses = {
                curiosity: 'è®°ä½ï¼Œå¥½å¥‡å¿ƒæ˜¯æ¢ç´¢å®‡å®™çš„ç¬¬ä¸€æ­¥ï¼ä¿æŒè¿™ä»½æ±‚çŸ¥æ¬²ï¼Œä½ ä¼šå‘ç°ç”Ÿæ´»ä¸­æœ‰æ— æ•°å€¼å¾—æ¢ç´¢çš„ç§˜å¯†ã€‚ç»§ç»­å‰è¿›å§ï¼Œå……æ»¡å¥½å¥‡å¿ƒçš„å°æ¢é™©å®¶ï¼',
                caring: 'åƒåœ°çƒä¸€æ ·å…³çˆ±ä»–äººï¼Œè¿™æ˜¯å®‡å®™ä¸­æœ€çè´µçš„å“è´¨ä¹‹ä¸€ã€‚ä½ çš„æ¸©æš–å’Œå–„è‰¯ä¼šè®©è¿™ä¸ªä¸–ç•Œå˜å¾—æ›´åŠ ç¾å¥½ã€‚ç»§ç»­å‘å…‰å‘çƒ­å§ï¼Œæ¸©æŸ”çš„å°æ’æ˜Ÿï¼',
                shining: 'æ¯é¢—æ˜Ÿæ˜Ÿéƒ½æœ‰è‡ªå·±çš„å…‰èŠ’ï¼Œä½ æ­£åœ¨åŠªåŠ›æˆä¸ºçš„é‚£é“å…‰ï¼Œå·²ç»ç…§äº®äº†èº«è¾¹çš„ä¸€åˆ‡ã€‚ç›¸ä¿¡è‡ªå·±ï¼Œä½ å°±æ˜¯é‚£é¢—ç‹¬ä¸€æ— äºŒçš„æ˜Ÿæ˜Ÿï¼'
            };

            document.getElementById('finalText').textContent = responses[choice];
            document.getElementById('finalMessage').style.display = 'block';
        }

        function restartGame() {
            resetGameState();
            document.getElementById('completeCard').style.display = 'none';
            document.getElementById('finalMessage').style.display = 'none';
            document.getElementById('infoCard').classList.remove('show');

            // é‡ç½®å®‡èˆªæœæŒ‰é’®
            const button = document.getElementById('spacesuitBtn');
            button.textContent = 'ğŸ‘©â€ğŸš€ ç©¿ä¸Šå®‡èˆªæœ';
            button.style.background = 'linear-gradient(135deg, #ff6b6b, #ff8e8e)';
            button.style.opacity = '1';
            button.style.cursor = 'pointer';
            button.onclick = wearSpacesuit;

            // é‡ç½®æ˜ŸçƒçŠ¶æ€
            document.querySelectorAll('.planet').forEach(planet => {
                const mark = planet.querySelector('.explored-mark');
                if (mark) mark.remove();
                planet.style.animation = '';
            });

            // å‘é€æ¶ˆæ¯ç»™çˆ¶çª—å£
            if (window.parent !== window) {
                window.parent.postMessage('returnToMenu', '*');
            } else {
                window.location.href = '../index.html';
            }

            switchScene(1);
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        window.onload = function() {
            initStars();
            loadGameState();

            if (gameState.wearingSpacesuit) {
                const button = document.getElementById('spacesuitBtn');
                if (button) {
                    button.textContent = 'âœ… å®‡èˆªæœå·²ç©¿æˆ´';
                    button.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
                    button.style.opacity = '0.8';
                    button.style.cursor = 'not-allowed';
                    button.onclick = null;
                }

                setTimeout(() => {
                    document.querySelectorAll('.planet').forEach(planet => {
                        planet.style.animation = 'pulse 1.5s infinite';
                    });
                }, 100);
            }
        };
    </script>
</body>
</html>
